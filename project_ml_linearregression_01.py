# -*- coding: utf-8 -*-
"""Project_ML_LinearRegression_01.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1_RxI7ErJc0SAoS3nm_5Jak-gb0cRn6kf

# Linear Regression Algorithm:
"""

#Example :01
#step No: 01 Importing Library

import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
import pickle
from sklearn.model_selection import train_test_split
from sklearn.metrics import r2_score
from sklearn.linear_model import LinearRegression


#Step 02 Inserting Data set

data = pd.read_csv("/content/linear_regression_dataset.csv")

#Step 3: Data Cleaning

data.describe()

data.isnull().sum()

data = data.drop_duplicates()

data = data.fillna({'Experience':data['Experience'].mean(),'Age':data['Age'].mean()})

# Outliers removing in Age Column

Q1 = data['Age'].quantile(0.25)
Q3 = data['Age'].quantile(0.75)

IQR = Q3 - Q1
upper = Q3 + 1.5*IQR
lower = Q1 - 1.5*IQR

data = data[(data['Age']>= lower) & (data['Age']<=upper)]

# Outliers removing in Experience Column

Q1 = data['Experience'].quantile(0.25)
Q3 = data['Experience'].quantile(0.75)

IQR = Q3 - Q1
upper = Q3 + 1.5*IQR
lower = Q1 - 1.5*IQR

data = data[(data['Experience']>= lower) & (data['Experience']<=upper)]


#Step 4: Spliting data

x = data[['Experience', 'Education_Level', 'Age']]
y = data['Salary']


#step 5 training data

x_train,x_test,y_train,y_test = train_test_split(x,y,test_size=0.2,random_state=42)

#Step 6 Model Creation

model = LinearRegression()

#Step 7: Model Training

model.fit(x_train,y_train)

#Step 8: Download pickel file

pickle.dump(model,open('Linear_model.pkl','wb'))
print("Downloaded successfully!!!")